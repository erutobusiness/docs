# エンジニアリング・ライフサイクル (SDLC)

> [!NOTE]
> 🔄 **SDLC** (Software Development Life Cycle)：ソフトウェアの「企画・設計・実装・テスト・運用・保守」という一連の流れ。

Baby Cup のプロセスは、まさにこの **SDLC** の縮図です。
構築から対戦、そして振り返りまでの流れをエンジニアリングの視点で紐解いてみましょう。

---

## Phase 1: 設計 (Design) - 構築とチーム編成

すべては設計から始まります。
ここでの意思決定が、その後のすべてのフェーズを左右します。

### 構築考察 = 要件定義 & アーキテクチャ設計

- **環境分析（メタ読み）**: 現在のトレンド技術（メタ）の把握
  - **Legacy** (枯れた技術): 炎・水・草の3すくみ。
古いが安定している。
  - **Modern** (流行技術): 「水（ギャラドス等）」←「電気（デンリュウ等）」←「地面（ガブリアス・ドリュウズ等）」 の3強構造。
    - これを無視した設計は、デプロイ（場に出す）した瞬間に炎上（即死）します。
- **コンセプト決定**: 「漁夫の利（ハイエナ）」を狙うか、広範囲AOEで殲滅するか
  - **Kill Steal 戦略**: 他のプロセスが処理（攻撃）して弱ったタスク（敵）を、横から奪う（トドメを刺す）ことで **スループット**（単位時間あたりの処理量＝ポイント）を最大化する設計。

### チーム構成 = システムアーキテクチャ

3体という極小のリソースでシステムを稼働させる必要があります。

| ポケモン対戦 | エンジニアリング |
| :--- | :--- |
| **電気（デンリュウ等）** | **高負荷処理サーバー** - 「じゅうでん＋10万ボルト」による遠距離からの高火力処理 |
| **地面（ガブリアス等）** | **耐障害性の基盤** - 電気無効により、環境トップの負荷（攻撃）を無効化する |
| **オヤブン個体の採用** | **垂直スケーリング (Scale Up)** - サーバー自体のスペック（個体サイズ）を上げること。当たり判定（攻撃範囲）を拡大するが、被弾リスク（コスト）も増大する。 |

> [!CAUTION]
> **「単一障害点 (SPOF)」の排除**
> **SPOF** (Single Point of Failure) とは、そこが壊れるとシステム全体が止まってしまう弱点のことです。
> 3体しかいないため、特に「対電気（地面枠）」を失うと、システム全体がサービスダウン（全滅）するリスクがあります。

---

## Phase 2: 実装 (Implementation) - 厳選と育成

仕様が決まったら実装です。
ZAでは「ステータス」だけでなく「物理的なサイズ」や「挙動」の実装が勝敗を分けます。

### 厳選・努力値振り = コーディング & チューニング

- **個体厳選**: バグのないきれいなコードを書くこと。
妥協した個体（バグの潜むコード）は、本番で予期せぬ挙動を引き起こします。
- **努力値振り**: パフォーマンスチューニング。
「S調整で先手を取る」のは「レイテンシ（遅延）を削ってレスポンスを速くする」のと全く同じ思考です。

- **個体サイズ（Size Optimization）**:
  - **Dockerイメージの軽量化 (XSサイズ)**: マッギョやフラエッテのような小型・薄型ポケモンを採用し、敵からの **視認性 (Visibility)** を下げる「ステルス実装」が有効。
  - **リッチな機能実装 (オヤブン/XLサイズ)**: 攻撃範囲は広いが、敵からのロックオン（アクセス）を集めやすいため、堅牢なセキュリティ（耐久）が必須。
- **努力値・性格**:
  - 制限時間3分のリアルタイムバトルのため、「いじっぱり（攻撃↑）ぶっぱ」 のような、処理速度（DPS）に全振りしたチューニングが推奨。
  - 耐久調整等の細かいリファクタリングは、環境が成熟してからでOK。

> [!WARNING]
> **技術的負債 (Technical Debt)**
> 「まあいいか」で妥協した個体や努力値調整のこと。
> これらは借金のように利息（メンテナンスコスト）を生み続け、大事な場面（昇格戦や大規模トラフィック時）で必ず足を引っ張り返済を迫られます。

---

## Phase 3: 運用 (Operation) - 対戦本番

いよいよ本番の対戦です。
リアルタイムで変化する戦況を、大量のログとして監視し続ける必要があります。

### モニタリング & オブザーバビリティ (Observability)

**Observability** (可観測性) とは、システムの「中身」の状態を、出力（ログやメトリクス）からどれだけ推測できるかという指標です。
画面上の情報は全てログです。
これを正しくパース（解釈）できるかがSREの腕の見せ所です。

- **トレーナーの挙動監視**: 敵ポケモンだけでなく、敵トレーナーの「視線（カメラの向き）」や「予備動作（腕を振る）」を監視。
  - これにより、APIリクエスト（攻撃技）が飛んでくる前に回避行動をとれる。
- **プレイヤーリスト確認**: 誰が誰を狙っているか（ヘイト管理）、誰がリスポーン待ちかを常にダッシュボード（画面右下）で監視。

> [!TIP]
> **「キビス返し」テクニック**
> 技を撃った直後にキャラを反転させることで、ログ（見た目）をごまかし、相手の予測（オートスケーリング）を誤らせる高等テクニックも存在します。

#### 交代（Switching） = 最強の防御行動（Workaround）

Baby Cup（特にZAルール）では、**「交代」がすべての技を回避できる最強の防御行動**と言えます。
**Workaround** (回避策) とは、根本解決ではないが、とりあえず問題を回避する応急処置のことです。
不利な状況（バグや障害）へ直面したとき、正面から受けず「安全な場所へ逃げる（ロールバックする、トラフィックを迂回させる）」判断ができるかどうか。

> **Rollback** (ロールバック): 不具合が起きた際、システムを前の正常な状態に戻すこと。

1.  相手に「交代」を強要する（負荷を分散させる）
2.  他プレイヤーの「交代権」を枯渇させる（リソースを使い切らせる）

これが、安定運用の鉄則です。
ここで問われるのは、瞬時の判断力と、パニックを避けてリカバリーする力（SRE力）です。

---

## Phase 4: 改善 (Feedback) - ポストモーテム

3分間の運用が終わったら、ログ解析です。

### KPI分析 (Score Analysis)

単に「勝った/負けた」ではなく、以下の **KPI** (重要な業績の評価指標) で評価します。

- **Last Hit Ratio (トドメ率)**: ダメージを与えた量ではなく、最終的に「Kill」を取れたか。
  - ZAは「ポイント制」であり、中途半端なダメージは敵の「きのみ（自動回復）」で吸収されるだけの無駄なコスト。
- **Item Acquisition (リソース回収率)**: フィールドに落ちる「メガカケラ」や「攻撃アップアイテム」を拾えたか。
  - これらはシステムの基礎スペックを底上げする重要なパッチ適用作業。

### 感想戦 = ポストモーテム (事後検証)

負けた試合（障害）こそ、学びの宝庫です。
エンジニアリングにおいて重要なのは **「誰が悪かったか（犯人探し）」ではなく「なぜ起きたか（仕組みの不備）」** を追求する **Blameless** (非難なし) な姿勢です。

- ❌ 「あの時、お前が交代しなかったから負けた」
- ⭕ 「交代のリスクを過大に見積もってしまう構築の欠陥があったのでは？」

### サイクルを回す (CI/CD)

得られた知見を元に、構築（設計）を見直し、育成（実装）し直して、次の対戦（運用）に挑む。
「なぜ電気が通らなかったのか？（地面枠の増加）」、「なぜリスポーン狩りされたのか？（位置取りの悪さ）」を分析し、パーティ構成（アーキテクチャ）を見直します。
この高速な改善サイクルこそが、**アジャイル開発** そのものです。

---

## まとめ

Baby Cup で勝つためのプロセスは、優れたソフトウェアを作るプロセスと一致します。

1.  **堅牢な設計** (Design) - SPOFをなくす
2.  **妥協のない実装** (Implementation) - 技術的負債を残さない
3.  **柔軟な運用** (Operation) - リスクを回避し続ける
4.  **建設的な振り返り** (Postmortem) - 失敗から学ぶ

ポケモンを通じて、私たちはエンジニアとして大切な「システムを育て、守り、改善する力」を養っているのです。
